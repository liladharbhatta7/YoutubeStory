# Nepali YouTube Shorts Automator

A fully automated production pipeline to generate, voice, edit, and schedule 3 Nepali YouTube Shorts daily.

## Features
- **Stories**: Generated by Google Gemini (Strict JSON)
- **Visuals**: AI Images via Pollinations
- **Audio**: Nepali narration via ElevenLabs
- **Editing**: FFmpeg with Ken Burns effect, text overlays, and audio mixing
- **Scheduling**: YouTube Data API v3 (Auto NPT -> UTC conversion)
- **Infrastructure**: GitHub Actions (Cron: 5:00 AM NPT)

## Setup Instructions

### 1. Prerequisites
- Python 3.11+
- FFmpeg installed
- Accounts: Google Cloud (Gemini & YouTube), ElevenLabs

### 2. Install Dependencies
```bash
pip install -r requirements.txt
```

### 3. API Keys & Secrets
Create a `.env` file locally or set these as GitHub Actions Secrets:

| Secret Name | Description |
|---|---|
| `GEMINI_API_KEY` | Google AI Studio Key |
| `ELEVENLABS_API_KEY` | ElevenLabs API Key |
| `YOUTUBE_CLIENT_ID` | OAuth Client ID |
| `YOUTUBE_CLIENT_SECRET` | OAuth Client Secret |
| `YOUTUBE_REFRESH_TOKEN` | OAuth Refresh Token (See below) |

#### How to get YouTube Refresh Token
1. Create a Project in Google Cloud Console.
2. Enable "YouTube Data API v3".
3. Configure OAuth Consent Screen (External, add yourself as tester).
4. Create Credentials (OAuth Client ID -> Web Application).
   - Redirect URI: `https://developers.google.com/oauthplayground`
5. Go to [OAuth 2.0 Playground](https://developers.google.com/oauthplayground).
   - Select "YouTube Data API v3" -> `https://www.googleapis.com/auth/youtube.upload`.
   - Click "Authorize APIs".
   - Exchange authorization code for tokens.
   - Copy the `Refresh Token`.

### 4. Configuration
- Add topics to `config/topics.json`.
- Add Background Music mp3s to `assets/music/`.
- (Optional) Adjust prompt in `config/gemini_prompt.txt`.

### 5. Running Locally
```bash
python -m src.main --count 1
```

### 6. GitHub Actions
The workflow `.github/workflows/daily.yml` runs automatically at 5:00 AM NPT.
It persists `state/state.json` to track used topics and rotation.

## Artifacts
After each run, check the GitHub Actions "Summary" for:
- `report.json`: Status of all videos.
- `logs.txt`: Detailed logs.
- `state-json`: Persistent state file.

## Fonts
The system expects `assets/fonts/NotoSansDevanagari-Bold.ttf`.
The GitHub Action attempts to install and copy it from `fonts-noto`.
Locally, please download a bold Devanagari font and place it there for best text rendering results.
